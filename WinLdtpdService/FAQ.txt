Q: Why check / uncheck menuitem doesn't work ?
A: Its due to underlying issue as mentioned here http://msdn.microsoft.com/en-us/library/ms746680.aspx#Legacy_Issues

Q: Why hasstate('Window', 'Object', state.FOCUSED) value is incorrect ?
A: Some window focus doesn't work, so you have to call first grabfocus('Window', 'Object') and then call hasstate.
 This could be an issue during verification, but we have to live with it, sorry.
